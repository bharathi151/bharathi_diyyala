{"filter":false,"title":"utils.py","tooltip":"/mysite/optimize/utils.py","undoManager":{"mark":49,"position":49,"stack":[[{"start":{"row":31,"column":17},"end":{"row":32,"column":0},"action":"insert","lines":["",""],"id":1},{"start":{"row":32,"column":0},"end":{"row":32,"column":4},"action":"insert","lines":["    "]},{"start":{"row":32,"column":4},"end":{"row":33,"column":0},"action":"insert","lines":["",""]},{"start":{"row":33,"column":0},"end":{"row":33,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":33,"column":0},"end":{"row":33,"column":4},"action":"remove","lines":["    "],"id":2}],[{"start":{"row":33,"column":0},"end":{"row":42,"column":17},"action":"insert","lines":["@profile()","def get_books_by_library_id_one_query(book_ids):","    from library_app.models import Book","    from collections import defaultdict","    books = Book.objects.filter(id__in=book_ids)","    result = defaultdict(list)","    ","    for book in books:","        result[book.library_id].append(book)","    return result"],"id":3}],[{"start":{"row":35,"column":19},"end":{"row":35,"column":20},"action":"remove","lines":["p"],"id":4},{"start":{"row":35,"column":18},"end":{"row":35,"column":19},"action":"remove","lines":["p"]},{"start":{"row":35,"column":17},"end":{"row":35,"column":18},"action":"remove","lines":["a"]},{"start":{"row":35,"column":16},"end":{"row":35,"column":17},"action":"remove","lines":["_"]},{"start":{"row":35,"column":15},"end":{"row":35,"column":16},"action":"remove","lines":["y"]},{"start":{"row":35,"column":14},"end":{"row":35,"column":15},"action":"remove","lines":["r"]},{"start":{"row":35,"column":13},"end":{"row":35,"column":14},"action":"remove","lines":["a"]},{"start":{"row":35,"column":12},"end":{"row":35,"column":13},"action":"remove","lines":["r"]},{"start":{"row":35,"column":11},"end":{"row":35,"column":12},"action":"remove","lines":["b"]},{"start":{"row":35,"column":10},"end":{"row":35,"column":11},"action":"remove","lines":["i"]},{"start":{"row":35,"column":9},"end":{"row":35,"column":10},"action":"remove","lines":["l"]}],[{"start":{"row":35,"column":9},"end":{"row":35,"column":10},"action":"insert","lines":["o"],"id":5},{"start":{"row":35,"column":10},"end":{"row":35,"column":11},"action":"insert","lines":["p"]},{"start":{"row":35,"column":11},"end":{"row":35,"column":12},"action":"insert","lines":["t"]},{"start":{"row":35,"column":12},"end":{"row":35,"column":13},"action":"insert","lines":["i"]}],[{"start":{"row":35,"column":9},"end":{"row":35,"column":13},"action":"remove","lines":["opti"],"id":6},{"start":{"row":35,"column":9},"end":{"row":35,"column":17},"action":"insert","lines":["optimize"]}],[{"start":{"row":42,"column":17},"end":{"row":43,"column":0},"action":"insert","lines":["",""],"id":7},{"start":{"row":43,"column":0},"end":{"row":43,"column":4},"action":"insert","lines":["    "]},{"start":{"row":43,"column":4},"end":{"row":44,"column":0},"action":"insert","lines":["",""]},{"start":{"row":44,"column":0},"end":{"row":44,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":44,"column":0},"end":{"row":44,"column":4},"action":"remove","lines":["    "],"id":8}],[{"start":{"row":44,"column":0},"end":{"row":56,"column":17},"action":"insert","lines":["def get_books_by_author():","    from library_app.models import Book         ","    from collections import defaultdict    ","    books = Book.objects.all()","    result = defaultdict(list)","    for book in books:","        author = book.author","        title_and_author = '{} by {}'.format(","            book.title,","            author.name","        )","        result[book.library_id].append(title_and_author)","    return result"],"id":9}],[{"start":{"row":56,"column":17},"end":{"row":57,"column":0},"action":"insert","lines":["",""],"id":10},{"start":{"row":57,"column":0},"end":{"row":57,"column":4},"action":"insert","lines":["    "]},{"start":{"row":57,"column":4},"end":{"row":58,"column":0},"action":"insert","lines":["",""]},{"start":{"row":58,"column":0},"end":{"row":58,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":58,"column":0},"end":{"row":58,"column":4},"action":"remove","lines":["    "],"id":11}],[{"start":{"row":58,"column":0},"end":{"row":70,"column":17},"action":"insert","lines":["def get_books_by_author_select_related():","    from library_app.models import Book","    from collections import defaultdict","    books = Book.objects.all().select_related('author')","    result = defaultdict(list)","    for book in books:","        author = book.author","        title_and_author = '{} by {}'.format(","            book.title,","            author.name","        )","        result[book.library_id].append(title_and_author)","    return result"],"id":12}],[{"start":{"row":45,"column":19},"end":{"row":45,"column":20},"action":"remove","lines":["p"],"id":13},{"start":{"row":45,"column":18},"end":{"row":45,"column":19},"action":"remove","lines":["p"]},{"start":{"row":45,"column":17},"end":{"row":45,"column":18},"action":"remove","lines":["a"]},{"start":{"row":45,"column":16},"end":{"row":45,"column":17},"action":"remove","lines":["_"]},{"start":{"row":45,"column":15},"end":{"row":45,"column":16},"action":"remove","lines":["y"]},{"start":{"row":45,"column":14},"end":{"row":45,"column":15},"action":"remove","lines":["r"]},{"start":{"row":45,"column":13},"end":{"row":45,"column":14},"action":"remove","lines":["a"]},{"start":{"row":45,"column":12},"end":{"row":45,"column":13},"action":"remove","lines":["r"]},{"start":{"row":45,"column":11},"end":{"row":45,"column":12},"action":"remove","lines":["b"]},{"start":{"row":45,"column":10},"end":{"row":45,"column":11},"action":"remove","lines":["i"]}],[{"start":{"row":45,"column":9},"end":{"row":45,"column":10},"action":"remove","lines":["l"],"id":14}],[{"start":{"row":45,"column":9},"end":{"row":45,"column":10},"action":"insert","lines":["o"],"id":15},{"start":{"row":45,"column":10},"end":{"row":45,"column":11},"action":"insert","lines":["p"]},{"start":{"row":45,"column":11},"end":{"row":45,"column":12},"action":"insert","lines":["t"]},{"start":{"row":45,"column":12},"end":{"row":45,"column":13},"action":"insert","lines":["i"]},{"start":{"row":45,"column":13},"end":{"row":45,"column":14},"action":"insert","lines":["m"]},{"start":{"row":45,"column":14},"end":{"row":45,"column":15},"action":"insert","lines":["i"]}],[{"start":{"row":45,"column":15},"end":{"row":45,"column":16},"action":"insert","lines":["x"],"id":16}],[{"start":{"row":45,"column":15},"end":{"row":45,"column":16},"action":"remove","lines":["x"],"id":17}],[{"start":{"row":45,"column":15},"end":{"row":45,"column":16},"action":"insert","lines":["z"],"id":18},{"start":{"row":45,"column":16},"end":{"row":45,"column":17},"action":"insert","lines":["e"]}],[{"start":{"row":59,"column":19},"end":{"row":59,"column":20},"action":"remove","lines":["p"],"id":19},{"start":{"row":59,"column":18},"end":{"row":59,"column":19},"action":"remove","lines":["p"]},{"start":{"row":59,"column":17},"end":{"row":59,"column":18},"action":"remove","lines":["a"]},{"start":{"row":59,"column":16},"end":{"row":59,"column":17},"action":"remove","lines":["_"]},{"start":{"row":59,"column":15},"end":{"row":59,"column":16},"action":"remove","lines":["y"]},{"start":{"row":59,"column":14},"end":{"row":59,"column":15},"action":"remove","lines":["r"]},{"start":{"row":59,"column":13},"end":{"row":59,"column":14},"action":"remove","lines":["a"]},{"start":{"row":59,"column":12},"end":{"row":59,"column":13},"action":"remove","lines":["r"]},{"start":{"row":59,"column":11},"end":{"row":59,"column":12},"action":"remove","lines":["b"]},{"start":{"row":59,"column":10},"end":{"row":59,"column":11},"action":"remove","lines":["i"]},{"start":{"row":59,"column":9},"end":{"row":59,"column":10},"action":"remove","lines":["l"]},{"start":{"row":59,"column":8},"end":{"row":59,"column":9},"action":"remove","lines":[" "]}],[{"start":{"row":59,"column":8},"end":{"row":59,"column":9},"action":"insert","lines":[" "],"id":20},{"start":{"row":59,"column":9},"end":{"row":59,"column":10},"action":"insert","lines":["o"]},{"start":{"row":59,"column":10},"end":{"row":59,"column":11},"action":"insert","lines":["p"]},{"start":{"row":59,"column":11},"end":{"row":59,"column":12},"action":"insert","lines":["t"]},{"start":{"row":59,"column":12},"end":{"row":59,"column":13},"action":"insert","lines":["i"]},{"start":{"row":59,"column":13},"end":{"row":59,"column":14},"action":"insert","lines":["m"]},{"start":{"row":59,"column":14},"end":{"row":59,"column":15},"action":"insert","lines":["i"]}],[{"start":{"row":59,"column":15},"end":{"row":59,"column":16},"action":"insert","lines":["z"],"id":21},{"start":{"row":59,"column":16},"end":{"row":59,"column":17},"action":"insert","lines":["e"]}],[{"start":{"row":57,"column":1},"end":{"row":57,"column":2},"action":"remove","lines":[" "],"id":22},{"start":{"row":57,"column":0},"end":{"row":57,"column":1},"action":"remove","lines":[" "]}],[{"start":{"row":57,"column":0},"end":{"row":57,"column":1},"action":"insert","lines":["@"],"id":23},{"start":{"row":57,"column":1},"end":{"row":57,"column":2},"action":"insert","lines":["p"]},{"start":{"row":57,"column":2},"end":{"row":57,"column":3},"action":"insert","lines":["r"]}],[{"start":{"row":57,"column":4},"end":{"row":57,"column":5},"action":"remove","lines":[" "],"id":24},{"start":{"row":57,"column":3},"end":{"row":57,"column":4},"action":"remove","lines":[" "]}],[{"start":{"row":57,"column":3},"end":{"row":57,"column":4},"action":"insert","lines":["o"],"id":25}],[{"start":{"row":57,"column":1},"end":{"row":57,"column":4},"action":"remove","lines":["pro"],"id":26},{"start":{"row":57,"column":1},"end":{"row":57,"column":10},"action":"insert","lines":["profile()"]}],[{"start":{"row":43,"column":0},"end":{"row":43,"column":1},"action":"insert","lines":["@"],"id":27},{"start":{"row":43,"column":1},"end":{"row":43,"column":2},"action":"insert","lines":["p"]}],[{"start":{"row":43,"column":1},"end":{"row":43,"column":2},"action":"remove","lines":["p"],"id":28},{"start":{"row":43,"column":1},"end":{"row":43,"column":10},"action":"insert","lines":["profile()"]}],[{"start":{"row":70,"column":17},"end":{"row":71,"column":0},"action":"insert","lines":["",""],"id":29},{"start":{"row":71,"column":0},"end":{"row":71,"column":4},"action":"insert","lines":["    "]},{"start":{"row":71,"column":4},"end":{"row":72,"column":0},"action":"insert","lines":["",""]},{"start":{"row":72,"column":0},"end":{"row":72,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":72,"column":0},"end":{"row":72,"column":4},"action":"remove","lines":["    "],"id":30}],[{"start":{"row":72,"column":0},"end":{"row":84,"column":17},"action":"insert","lines":["def get_books_by_author_select_related():","    from library_app.models import Book","    from collections import defaultdict","    books = Book.objects.all().select_related('author')","    result = defaultdict(list)","    for book in books:","        author = book.author","        title_and_author = '{} by {}'.format(","            book.title,","            author.name","        )","        result[book.library_id].append(title_and_author)","    return result"],"id":31}],[{"start":{"row":72,"column":0},"end":{"row":84,"column":17},"action":"remove","lines":["def get_books_by_author_select_related():","    from library_app.models import Book","    from collections import defaultdict","    books = Book.objects.all().select_related('author')","    result = defaultdict(list)","    for book in books:","        author = book.author","        title_and_author = '{} by {}'.format(","            book.title,","            author.name","        )","        result[book.library_id].append(title_and_author)","    return result"],"id":32}],[{"start":{"row":72,"column":0},"end":{"row":72,"column":1},"action":"insert","lines":["@"],"id":33},{"start":{"row":72,"column":1},"end":{"row":72,"column":2},"action":"insert","lines":["p"]},{"start":{"row":72,"column":2},"end":{"row":72,"column":3},"action":"insert","lines":["r"]}],[{"start":{"row":72,"column":1},"end":{"row":72,"column":3},"action":"remove","lines":["pr"],"id":34},{"start":{"row":72,"column":1},"end":{"row":72,"column":10},"action":"insert","lines":["profile()"]}],[{"start":{"row":72,"column":10},"end":{"row":73,"column":0},"action":"insert","lines":["",""],"id":35}],[{"start":{"row":73,"column":0},"end":{"row":89,"column":17},"action":"insert","lines":["def get_books_by_author_select_related_values():","    from library_app.models import Book","    from collections import defaultdict","    books = (","        Book.objects","         .all()","         .values('title', 'library_id', 'author__name')","    )","    result = defaultdict(list)","    for book in books.iterator():","        title_and_author = '{} by {}'.format(","            book['title'],","            book['author__name']","        )","        result[book['library_id']].append(title_and_author)","    ","    return result"],"id":36}],[{"start":{"row":74,"column":19},"end":{"row":74,"column":20},"action":"remove","lines":["p"],"id":37},{"start":{"row":74,"column":18},"end":{"row":74,"column":19},"action":"remove","lines":["p"]},{"start":{"row":74,"column":17},"end":{"row":74,"column":18},"action":"remove","lines":["a"]},{"start":{"row":74,"column":16},"end":{"row":74,"column":17},"action":"remove","lines":["_"]},{"start":{"row":74,"column":15},"end":{"row":74,"column":16},"action":"remove","lines":["y"]},{"start":{"row":74,"column":14},"end":{"row":74,"column":15},"action":"remove","lines":["r"]},{"start":{"row":74,"column":13},"end":{"row":74,"column":14},"action":"remove","lines":["a"]},{"start":{"row":74,"column":12},"end":{"row":74,"column":13},"action":"remove","lines":["r"]},{"start":{"row":74,"column":11},"end":{"row":74,"column":12},"action":"remove","lines":["b"]},{"start":{"row":74,"column":10},"end":{"row":74,"column":11},"action":"remove","lines":["i"]},{"start":{"row":74,"column":9},"end":{"row":74,"column":10},"action":"remove","lines":["l"]}],[{"start":{"row":74,"column":9},"end":{"row":74,"column":10},"action":"insert","lines":["o"],"id":38},{"start":{"row":74,"column":10},"end":{"row":74,"column":11},"action":"insert","lines":["p"]}],[{"start":{"row":74,"column":9},"end":{"row":74,"column":11},"action":"remove","lines":["op"],"id":39},{"start":{"row":74,"column":9},"end":{"row":74,"column":17},"action":"insert","lines":["optimize"]}],[{"start":{"row":89,"column":17},"end":{"row":90,"column":0},"action":"insert","lines":["",""],"id":40},{"start":{"row":90,"column":0},"end":{"row":90,"column":4},"action":"insert","lines":["    "]},{"start":{"row":90,"column":4},"end":{"row":91,"column":0},"action":"insert","lines":["",""]},{"start":{"row":91,"column":0},"end":{"row":91,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":91,"column":0},"end":{"row":91,"column":4},"action":"remove","lines":["    "],"id":41}],[{"start":{"row":91,"column":0},"end":{"row":91,"column":1},"action":"insert","lines":["@"],"id":42},{"start":{"row":91,"column":1},"end":{"row":91,"column":2},"action":"insert","lines":["p"]}],[{"start":{"row":91,"column":1},"end":{"row":91,"column":2},"action":"remove","lines":["p"],"id":43},{"start":{"row":91,"column":1},"end":{"row":91,"column":10},"action":"insert","lines":["profile()"]}],[{"start":{"row":91,"column":10},"end":{"row":92,"column":0},"action":"insert","lines":["",""],"id":44},{"start":{"row":92,"column":0},"end":{"row":93,"column":0},"action":"insert","lines":["",""]},{"start":{"row":93,"column":0},"end":{"row":94,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":93,"column":0},"end":{"row":94,"column":0},"action":"remove","lines":["",""],"id":45},{"start":{"row":92,"column":0},"end":{"row":93,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":92,"column":0},"end":{"row":109,"column":17},"action":"insert","lines":["def get_books_by_author_select_related_values_list():","    from library_app.models import Book","    from collections import defaultdict","    books = (","        Book.objects","         .all()","         .select_related('author')","         .values_list('title', 'library_id', 'author__name')","    )","    result = defaultdict(list)","    for book in books.iterator():","        title_and_author = '{} by {}'.format(","            book[0],","            book[2]","        )","        result[book[1]].append(title_and_author)","    ","    return result"],"id":46}],[{"start":{"row":93,"column":19},"end":{"row":93,"column":20},"action":"remove","lines":["p"],"id":47},{"start":{"row":93,"column":18},"end":{"row":93,"column":19},"action":"remove","lines":["p"]},{"start":{"row":93,"column":17},"end":{"row":93,"column":18},"action":"remove","lines":["a"]},{"start":{"row":93,"column":16},"end":{"row":93,"column":17},"action":"remove","lines":["_"]},{"start":{"row":93,"column":15},"end":{"row":93,"column":16},"action":"remove","lines":["y"]},{"start":{"row":93,"column":14},"end":{"row":93,"column":15},"action":"remove","lines":["r"]},{"start":{"row":93,"column":13},"end":{"row":93,"column":14},"action":"remove","lines":["a"]},{"start":{"row":93,"column":12},"end":{"row":93,"column":13},"action":"remove","lines":["r"]},{"start":{"row":93,"column":11},"end":{"row":93,"column":12},"action":"remove","lines":["b"]},{"start":{"row":93,"column":10},"end":{"row":93,"column":11},"action":"remove","lines":["i"]}],[{"start":{"row":93,"column":9},"end":{"row":93,"column":10},"action":"remove","lines":["l"],"id":48}],[{"start":{"row":93,"column":9},"end":{"row":93,"column":10},"action":"insert","lines":["o"],"id":49},{"start":{"row":93,"column":10},"end":{"row":93,"column":11},"action":"insert","lines":["p"]}],[{"start":{"row":93,"column":9},"end":{"row":93,"column":11},"action":"remove","lines":["op"],"id":50},{"start":{"row":93,"column":9},"end":{"row":93,"column":17},"action":"insert","lines":["optimize"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":23,"column":38},"end":{"row":23,"column":38},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1585718818338,"hash":"bc51dd543dd1cfeec62853c00642b48c2a406dbd"}